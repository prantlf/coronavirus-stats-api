#!/usr/bin/env node

const { synchronizeData } = require('../lib/synchronizer')
const { serveApi } = require('../lib/server')
const { getLastLog } = require('../lib/database/engine')

synchronizeData()
  .then(() => serveApi())
  .catch(error => {
    const lastLog = getLastLog()
    process.stderr.write(`${lastLog}\n${error.message}\n`)
    process.exit(3)
  })
